#Call Detail Records (CDR) Management for CUCM

###Εισαγωγή

Η εταιρεία επικοινωνιών και πληροφορικής CISCO παρέχει το προϊόν _CUCM_ που αφορά σε υπηρεσίες VoIP τηλεφωνίας. Τα αρχικά CUCM σημαίνουν Cisco Unified Communications Manager και αφορούν στην πλατφόρμα λογισμικού διαχείρισης VoIP της CISCO. Ο CUCM παρέχει σειρά εργαλείων διαχείρισης VoIP τηλεφωνίας, ενώ παράλληλα καταγράφει τεράστιο πλήθος δεδομένων που αφορούν στις κλήσεις που διεκπεραιώνονται. Τα δεδομένα τα οποία καταγράφει ο CUCM είναι δύο ειδών: CDR (Call Detail Records) και CMR (Call Management Records). Το παρόν επικεντρώνεται στα CDR records.

Τα CDRs (call detail records) περιέχουν πληροφορίες που αφορούν σε κάθε κλήση, εισερχόμενη ή εξερχόμενη. Επιπλέον, υπάρχουν CDRs και για άλλες «κινήσεις» που γίνονται σε οποιαδήποτε τηλεφωνική συσκευή του δικτύου που ελέγχει ο CUCM· αν π.χ. σηκώσουμε το ακουστικό και κατόπιν το κατεβάσουμε χωρίς να πραγαμτοποιήσουμε κάποια κλήση, το συμβάν αυτό καταγράφεται επίσης σε ένα CDR. Η πληροφορία που παρέχουν τα CDRs είναι τεράστια, αλλά στο παρόν θα επικεντρωθούμε στα στοιχεία που μπορούν να μας φανούν χρήσιμα.

###Προσπελασιμότητα δεδομένων

Τα CDRs εξάγονται από τον CUCM σε text files με format CSV. Τα files αυτά είναι πάρα πολλά (περισσότερα από 1.000 files για κάθε ημέρα) και μεταφέρονται μέσω FTP σε server που καθορίζουμε από την κονσόλα διαχείρισης του CUCM από την οποία μπορούμε να καθορίσουμε και άλλα στοιχεία που αφορούν στην εξαγωγή (export) και στη μεταφορά (transport) των CDRs. Μπορούμε π.χ. να καθορίσουμε τη συχνότητα εξαγωγής των CDRs σε 1 λεπτό της ώρας, ή σε 5 λεπτά της ώρας. Μπορούμε, επίσης, να καθορίσουμε το μέγιστο μέγεθος των παραγομένων αρχείων σε 1MG, ή σε 3GB κοκ.

Αφού καθορίσουμε όλες τις παραμέτρους που αφορούν στη συχνότητα παραγωγής των αρχείων, στο μέγεθος των παραγόμενων αρχείων, τον server αποθήκευσης των αρχίων κλπ, μπορούμε να διαχειριστούμε τα CDRs ανεξάρτητα από τον CUCM είτε απευθείας από τα αρχεία τα οποία παράγονται, είτε μέσα από εργαλεία διαχείρισης βάσεων δεδομένων, εφόσον «φορτώσουμε» τα CDRs σε κάποια database. Το σχήμα το οποίο θα ακολουθήσουμε στο παρόν είναι:

- Παραγωγή των αρχείων κάθε ένα (1) λεπτό της ώρας
- Μεταφορά των αρχείων σε server υποδοχής δεδομένων
- Εισαγωγή των CDRs σε relational database

Ουσιαστικά, όλες οι εργασίες που περιγράφονται στο παρόν λαμβάνουν χώρα στον server υποδοχής δεδομένων και επιτελούνται σε δεύτερο χρόνο ανεξάρτητα από τον CUCM.

###Server υποδοχής

Στον server υποδοχής θα πρέπει να έχουμε εγκαταστήσει Linux, MySQL και όλα τα προγράμματα που περιγράφονται στο παρόν. Τα προγράμματα αυτά περιέχονται στο repository _cdr_ στο GitHub, επομένως στον server υποδοχής θα πρέπει να υπάρχει Git client προκειμένου να διατηρούμε ενημερωμένα τα προγράμματά μας. Επιπλέον, θα πρέπει να έχουμε καθορίσει τις παραμέτρους του FTP προκειμένου να καταστεί δυνατή η αποστολή των CDR files από τον CUCM στον server υποδοχής.

####Λογισμικό εφαρμογών CDR
Όπως αναφέραμε, τα προγράμματα διαχείρισης των CDRs περιέχονται στο repository _cdr_ του GitHub. Για να εγκαταστήσουμε τα προγράμματα στον server υποδοχής, κάνουμε clone το repository ως normal user και κατόπιν δημιουργούμε link στο /var/opt.